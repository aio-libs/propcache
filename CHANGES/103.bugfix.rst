Improved typing annotations, fixing some type errors under correct usage
and improving typing robustness generally -- by :user:`Dreamsorcerer`.
